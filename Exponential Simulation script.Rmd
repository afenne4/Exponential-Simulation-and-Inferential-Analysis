---
title: "Exponential Simulation and Inference"
author: "Alex Fennell"
date: "2/11/2022"
output: pdf_document
---

# Simulating the Exponential distribution

## Synopsis
This project will compare how statistics of a non-normal distribution are 
themselves normally distributed. A Monte Carlo procedure will be used to simulate
distributions of the mean and variance of the exponential distribution
which will then be compared to the theoretical mean and standard deviation of the
distribution. 

```{r,message=FALSE}
library(ggplot2)
library(gridExtra)
library(cowplot)
```

## Simulations
This simulation will use samples of size 40 with lambda=.2. There will be 1000
simulations to create a distribution

``` {r}
lambda=.2
#Number of Monte Carlo samples
S=1000
#size of Monte Carlo samples
n=40
#samples stored in matrix where columns are the size of the monte carlo samples
#and each row is an individual simulation
samp<-matrix(rexp(n*S,lambda),nrow=S,ncol=n)

```

## Sample Mean vs. Theoretical Mean
This next chunk of code will show a plot of the means from the Monte Carlo 
simulation with the theoretical mean overlayed as a dashed red vertical line. The
theoretical mean is calculated as 1/lambda
``` {r}
# Theoretical mean
Tmean<-1/lambda
# The function rowMeans calulates the mean for each row (one simulation), which 
#creates a distribution of means based on the Monte Carlo simulation
meanplot<-ggplot()+geom_histogram(aes(rowMeans(samp)),bins=30,color="black",fill="lightblue")
meanplot+geom_vline(xintercept=Tmean,linetype="dashed",color="red",size=1.5) +
    ggtitle("Distribution of Means of Exponential Simulation") +
    xlab("Means")+
    theme(plot.title = element_text(hjust = 0.5))
    
```

This histogram shows that the distibution of means sampled from the exponential
distribution is roughly normal with the highest density of responses centered 
around the theoretical mean (vertical red dashed line).

## Sample Variance vs. Theoretical Variance
This next chunk of code will show a plot of the variance from the Monte Carlo 
simulation with the theoretical variance overlayed as a dashed red vertical line.
The theoretical variance for exponential distribution is calculated as 1/lambda^2.
``` {r}
#Theoretical variance
Tvar<-1/lambda^2
# Using the apply function to calculate the variance for each row (one simulation),
# which creates a distribution of simulated variances
varplot<-ggplot()+
    geom_histogram(aes(apply(samp,1,var)),bins=30,color="black",fill="darkgreen")+
    geom_vline(xintercept=Tvar,linetype="dashed",color="red",size=1.5) +
    ggtitle("Distribution of Variance \nof Exponential Simulation") +
    xlab("Variance")+
    theme(plot.title = element_text(hjust = 0.5))

#Theoretical SD
Tsd<-sqrt(Tvar)
# Using the apply function to calculate the SD for each row (one simulation),
# which creates a distribution of simulated SDs
sdplot<-ggplot()+
    geom_histogram(aes(apply(samp,1,sd)),bins=30,color="black",fill="lightgreen")+
    geom_vline(xintercept=Tsd,linetype="dashed",color="red",size=1.5) +
    ggtitle("Distribution of Standard Deviation \nof Exponential Simulation") +
    xlab("Standard Deviation")+
    theme(plot.title = element_text(hjust = 0.5))
grid.arrange(varplot,sdplot,ncol=2)

```


